<!DOCTYPE html>
<html>
<head>
    <title>Duel des Bâtonnets</title>
    <link rel="stylesheet" href="../style.css">
    <meta charset="UTF-8">
</head>
<body>
    <h1>Duel des Bâtonnets</h1>
    <p>Chacun leur tour, les joueurs peuvent retirer 1, 2 ou 3 bâtonnets. Celui qui prend le dernier bâtonnet perd le duel.</p>
    <div id="sticks-container">
        <!-- Insérez ici les bâtonnets -->
    </div>
    <button id="startButton">Commencer le Duel</button>
    <p id="message"></p>
    <button id="removeButton" disabled>Valider</button>
    <button id="resetButton" style="display: none; text-align: center;">Rejouer</button>
</body>
<script>
    const sticksContainer = document.getElementById('sticks-container');
    const startButton = document.getElementById('startButton');
    const message = document.getElementById('message');
    const removeButton = document.getElementById('removeButton');
    let currentPlayer = 1;
    let sticksLeft = 0;
    let canRemoveSticks = false;
    let selectedSticks = 0;
    const maxSelectedSticks = 3;

    function createSticks(num) {
        sticksContainer.innerHTML = '';
        for (let i = 0; i < num; i++) {
            const stick = document.createElement('div');
            stick.classList.add('stick');
            stick.addEventListener('click', () => handleStickClick(stick));
            sticksContainer.appendChild(stick);
        }
    }

    function handleStickClick(stick) {
        if (canRemoveSticks) {
            if (stick.classList.contains('selected')) {
                stick.classList.remove('selected');
                selectedSticks -= 1;
            } else if (selectedSticks < maxSelectedSticks) {
                stick.classList.add('selected');
                selectedSticks += 1;
            }
            updateRemoveButton();
        }
    }

    function updateRemoveButton() {
        if (selectedSticks > 0) {
            removeButton.disabled = false;
        } else {
            removeButton.disabled = true;
        }
    }

    function setPlayerTurnColors() {
        if (currentPlayer === 1) {
            sticksContainer.classList.remove('player-2-turn');
            sticksContainer.classList.add('player-1-turn');
        } else {
            sticksContainer.classList.remove('player-1-turn');
            sticksContainer.classList.add('player-2-turn');
        }
    }

    startButton.addEventListener('click', function() {
        createSticks(21);
        startButton.disabled = true;
        message.textContent = `Joueur 1, c'est à vous !`;
        sticksLeft = 21;
        currentPlayer = 1;
        canRemoveSticks = true;
        removeButton.disabled = true;
        selectedSticks = 0;
        setPlayerTurnColors();
    });

    removeButton.addEventListener('click', function() {
        if (canRemoveSticks && selectedSticks > 0) {
            sticksLeft -= selectedSticks;

            const selectedSticksArray = document.querySelectorAll('.stick.selected');
            selectedSticksArray.forEach((stick, index) => {
                if (index < selectedSticks) {
                    sticksContainer.removeChild(stick);
                }
            });

            if (sticksLeft === 0) {
                message.textContent = `Le Joueur ${currentPlayer} a perdu !`;
                canRemoveSticks = false;
            } else {
                currentPlayer = (currentPlayer === 1) ? 2 : 1;
                message.textContent = `Joueur ${currentPlayer}, c'est à vous !`;
                selectedSticks = 0;
                removeButton.disabled = true;
                canRemoveSticks = true;
                setPlayerTurnColors();
            }
        }
    });

    resetButton.addEventListener('click', function() {
        location.reload();
    });
</script>
<style>
    .stick {
        width: 20px;
        height: 100px;
        background: #999;
        display: inline-block;
        margin: 5px;
    }

    .stick.selected {
        background: #ff0000; /* Couleur rouge pour les bâtonnets sélectionnés */
    }

    .player-1-turn .stick.selected {
        background: #ff0000; /* Rouge pour le Joueur 1 */
    }

    .player-2-turn .stick.selected {
        background: #0000ff; /* Bleu pour le Joueur 2 */
    }
</style>
</html>
